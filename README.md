# EtherNet/IP exploits

This repository contains the code used for verification of the attacks on EtherNet/IP as described in the paper 'Practical vulnerabilities and attacks of EtherNet/IP'.
The [OpENer](https://github.com/EIPStackGroup/OpENer) and [EIPScanner](https://github.com/nimbuscontrols/EIPScanner) libraries are used to simulate EtherNet/IP devices and interact with them. The EIPScanner library specifically is embedded in the source of this project, to allow for easy changes to the library.

## Requirements
All actors are run in Docker containers. This has several benefits:
- Compatibility is simplified
- It simulates a real-life situation where different actors are separate devices
- Through the use of `docker-compose`, orchestration of actors is simplified

The only requirements to simulate these attacks are Docker, Docker Compose and their respective requirements. This library has been tested on Windows and Linux.

## Usage
The actors are defined in `docker-compose.yml`. To simulate a specific attack, one has to simply call
```
docker-compose up {ATTACK_NAME}
```

Each attack relies on specific actors, these will be started automatically by Docker Compose.

The following attacks are available, see the related paper for details:
- `session_dos`: A Denial of Service attack on EtherNet/IP sessions.
- `io_dos`: A Denial of Service attack on IO Connections. Note that this attack does not succeed due to implementation details in OpENer.
- `mitm`: A Man-in-the-middle attack, achieved through ARP cache poisoning. When running this attack, all traffic between the EtherNet/IP device and the master is printed.
- `io_dos_debug`: This is simply the `io_dos` attack, combined with the `mitm` attack. This allows to more easily analyze why the `io_dos` attack does not work.

It is possible to run the other actors by themselves as well, to get a better idea of how they operate. This is done by replacing `{ATTACK_NAME}` by one of the following:
- `opener_adapter`: This is a simple EtherNet/IP dummy device used for all testing.
- `generic_scanner`: A scanner that simply reads specific data from the EtherNet/IP device at regular intervals. It does this through an EtherNet/IP session, and using explicit messaging.
- `io_scanner`: A scanner that sets up an IO connection to the EtherNet/IP device. Then, it continously communicates with the device, sending slightly different packets each time.

**For Windows users:** `cleanup.bat` may remove running containers and images unrelated to this project. Use it with caution.
